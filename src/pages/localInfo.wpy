<style lang="less">
page{
  background-color: #f7f7f7;
}
.price,
.localName,
.label,
.rule,
.localInfo,
.reportData,
.houseType,
.feature{
  background-color: #fff;
}
.banner{
  width: 100vw;
  height: 440rpx;
}
.price{
  width: 670rpx;
  padding: 40rpx;
  display: flex;
  align-items: center;
  justify-content: space-between;
}
.price text{
  font-size: 40rpx;
  color: #7bb312;
  font-weight: 600;
}
.price view{
  display: flex;
  align-items: center;
  justify-content: center;
  flex-direction:column;
  color: #fa5454;
  font-size: 34rpx !important;
}
.price view view{
  font-size: 20rpx !important;
}
.localName{
  width: 670rpx;
  padding: 0 40rpx;
  font-size: 38rpx;
  color: #343434;
  font-weight: 600;
}
.label{
  display: flex;
  align-items: center;
  justify-content: space-between;
  width: 670rpx;
  padding: 30rpx 40rpx;
}
.label view:nth-child(1){
  font-size: 20rpx;
  color: #9e9e9e;
  background-color: #f2f2f2;
  padding: 10rpx 20rpx;
}
.label view:nth-child(2),
.label icon{
  font-size: 30rpx !important;
  font-weight: 600;
  color: #343434;
  display: flex;
  align-items: center;
  justify-content: flex-end;
}


.localInfo{
  width: 670rpx;
  height: auto;
  padding: 35rpx 40rpx;
  margin-top: 20rpx;
}
.localInfo .localitem{
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 10rpx 0;
}
.localInfo .localitem view:nth-child(1){
  width: 160rpx;
  font-size: 27rpx;
  color: #979797;
}
.localInfo .localitem view:nth-child(2){
  width: 480rpx;
  font-size: 27rpx;
  color: #343434;
  overflow:hidden;
  text-overflow:ellipsis;
  white-space:nowrap;
}
.localInfo .localitem view:nth-child(3){
  width: 30rpx;
}
.localInfo .localitem icon{
  width: 30rpx !important;
  font-size: 27rpx;
  color: #979797;
}
.rule{
  width: 670rpx;
  padding: 40rpx;
  margin-top: 20rpx;
}
.ruleList{
  display: flex;
  align-items: center;
  justify-content: space-between;
}
.ruleList text{
  font-size: 35rpx;
  color: #343434;
  font-weight: 600;
}
.ruleList view,
.ruleList icon{
  display: flex;
  align-items: center;
  justify-content: space-between;
  font-size: 27rpx !important;
  color: #979797;
}
.rule .description{
  font-size: 28rpx;
  color: #343434;
  font-weight: 600;
  margin-top: 15rpx;
  padding: 44rpx 0;
}
.reportData{
  width: 750rpx;
  height: 150rpx;
  display: flex;
  align-items: center;
  justify-content: center;
  background-color: #fff;
  border-top: 1rpx solid #f2f2f2;
}
.reportDataBorder{
  width: 0rpx;
  height: 45rpx;
  border:1px solid #c6c6c6;
}
.dataCon{
  width: 374rpx;
  height: 150rpx;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-direction:column;
}
.dataCon view:nth-child(2){
  font-size: 35rpx;
  color: #333;
  font-weight: 600;
}
.dataCon view:nth-child(1){
  font-size: 25rpx;
  color: #979797;
}
.houseType{
  width: 670rpx;
  padding: 40rpx;
  white-space: nowrap;
  overflow:hidden;
}
.houseTypeItem{
  display: inline-block;
  width: 260rpx;
  margin-right: 30rpx;
}
.houseTypeItem image{
  width: 260rpx;
  height: 150rpx;
  border-radius: 20rpx;
}

.houseTypeItem view{
  padding: 5rpx 0;
}
.houseTypeItem view:nth-child(2){
  font-size: 30rpx;
  color: #343434;
  overflow:hidden;
  text-overflow:ellipsis;
  white-space:nowrap;
}
.houseTypeItem view:nth-child(3){
  font-size: 20rpx;
  color: #979797;
  overflow:hidden;
  text-overflow:ellipsis;
  white-space:nowrap;
}
.houseTypeItem view:nth-child(4){
  font-size: 25rpx;
  color: #7bb312;
  overflow:hidden;
  text-overflow:ellipsis;
  white-space:nowrap;
}
.feature{
  width: 670rpx;
  padding: 40rpx;
}
.featureItem{
  display: flex;
  justify-content: space-between;
  border-bottom: 1rpx solid #f0f0f0;
  padding: 20rpx 0;
}
.featureItem view:nth-child(1){
  width: 170rpx;
  font-size: 30rpx;
  color: #979797;
}
.featureItem view:nth-child(2){
  width: 500rpx;
  font-size: 30rpx;
  color: #343434;
  line-height: 50rpx;
}
.nav{
  position: fixed;
  bottom: 0;
  background-color: #fff;
  width: 750rpx;
  height: 150rpx;
  display: flex;
  align-items: center;
  justify-content: space-around;
}
.nav view:nth-child(2),
.nav view:nth-child(3){
  width: 248rpx;
  height: 95rpx;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 30rpx;
  border-radius: 20rpx;
}
.nav view:nth-child(1){
  width: 95rpx;
  height: 95rpx;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-direction: column;
  font-size: 20rpx;
  color: #343434;
}
.nav view:nth-child(1) icon{
  font-size: 40rpx !important;
  color: #343434;
}
.nav view:nth-child(2){
  background-color: #f5ffe1;
  color: #7bb312;
}
.nav view:nth-child(3){
  background-color: #7bb312;
  color: #fff;
}
.marginNav{
  margin-bottom: 170rpx;
}
.mobile{
  width:640rpx;
  background-color:#fff;
  padding:30rpx 0;
  border-radius:20rpx;
}
.selMobile{
  width:580rpx;
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:20rpx 30rpx;
  font-size: 27rpx;
  overflow:hidden;
  text-overflow:ellipsis;
  white-space:nowrap;
}
.mobileClose{
  width: 200rpx;
  height: 80rpx;
  border-radius: 20rpx;
  background-color: #7bb312;
  margin: 20rpx auto;
  color: #fff;
  font-size: 30rpx;
  display:flex;
  align-items:center;
  justify-content:center;
}
button{
  width: 100%;
  height: 100%;
  background-color: #f5ffe1;
  color:#7bb312;
}
</style>
<template>
  <view>
    <!-- swiperList -->
    <swiper class='banner' indicator-dots="true" autoplay='true' interval='5000' duration='2000'>
      <repeat for="{{swiperList}}" item="item">
        <swiper-item>
          <image class="banner" src="{{ requestImgUrl + item.img }}" />
        </swiper-item>
      </repeat>
    </swiper>
    <!-- <image class="banner" src="/img/test.jpg" /> -->
    <view class="price">
      <text>{{localList.money}}元/㎡</text>
      <view @tap="collection">
        <!-- 实心 -->
        <!-- <icon class="iconfont icon-shoucang" @tap="collection"></icon> -->
        <!-- 空心 -->
        <icon class="iconfont icon-shoucang1" @tap="collection"></icon>
        <view>已收藏</view>
      </view>
    </view>
    <view class="localName">{{localList.name}}</view>
    <view class="label">
      <view>开发商:{{localList.developer}}</view>
      <view @tap="goLocalMoreInfo">
        更多信息
        <icon class="iconfont icon-jiantou-you"></icon>
      </view>
    </view>
    <view class="localInfo">
      <view class="localitem">
        <view>开盘时间</view>
        <view>{{localList.opening_time}}</view>
        <view></view>
      </view>
      <view class="localitem">
        <view>合作周期</view>
        <view>{{localList.cooperate_time}}</view>
        <view></view>
      </view>
      <view class="localitem" @tap="showAddress">
        <view>楼盘地址</view>
        <view>{{localList.floor_address}}</view>
        <view>
          <icon class="iconfont icon-jiantou-you"></icon>
        </view>
      </view>
    </view>
    <view class="rule">
      <view class="ruleList">
        <text>导客规则</text>
        <view @tap="goRuleInfo">
          查看全部
          <icon class="iconfont icon-jiantou-you"></icon>
        </view>
      </view>
      <view class="description">提前报备1小时</view>
    </view>
    <view class="reportData">
      <view class="dataCon" @tap="goReportList">
        <view>报备有效期</view>
        <view>24小时</view>
      </view>
      <view class="reportDataBorder"></view>
      <view class="dataCon" @tap="goCollectionList">
        <view>带看保护期</view>
        <view>15天</view>
      </view>
    </view>
    <scroll-view scroll-x="true" class="houseType">
      <view class="houseTypeItem" @tap="updataLocal">
        <image class="banner" src="/img/test.jpg" />
        <view>名著</view>
        <view>141.02㎡</view>
        <view>296万</view>
      </view>
      <view class="houseTypeItem" @tap="updataLocal">
        <image class="banner" src="/img/test.jpg" />
        <view>名著</view>
        <view>141.02㎡</view>
        <view>296万</view>
      </view>
      <view class="houseTypeItem" @tap="updataLocal">
        <image class="banner" src="/img/test.jpg" />
        <view>名著</view>
        <view>141.02㎡</view>
        <view>296万</view>
      </view>
      <view class="houseTypeItem" @tap="updataLocal">
        <image class="banner" src="/img/test.jpg" />
        <view>名著</view>
        <view>141.02㎡</view>
        <view>296万</view>
      </view>
      <view class="houseTypeItem" @tap="updataLocal">
        <image class="banner" src="/img/test.jpg" />
        <view>名著</view>
        <view>141.02㎡</view>
        <view>296万</view>
      </view>
      <view class="houseTypeItem" @tap="updataLocal">
        <image class="banner" src="/img/test.jpg" />
        <view>名著</view>
        <view>141.02㎡</view>
        <view>296万</view>
      </view>

    </scroll-view>
    <view class="localName">远洋合能枫丹唐悦</view>
    <view class="feature">
      <view class="featureItem">
        <view class="featureName">教育</view>
        <view class="featureCon">内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容</view>
      </view>
      <view class="featureItem">
        <view class="featureName">教育</view>
        <view class="featureCon">内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容</view>
      </view>
      <view class="featureItem">
        <view class="featureName">教育</view>
        <view class="featureCon">内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容</view>
      </view>
      <view class="featureItem">
        <view class="featureName">教育</view>
        <view class="featureCon">内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容</view>
      </view>
      <view class="featureItem">
        <view class="featureName">教育</view>
        <view class="featureCon">内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容</view>
      </view>
      <view class="featureItem">
        <view class="featureName">教育</view>
        <view class="featureCon">内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容内容</view>
      </view>
    </view>
    <view class="localName">远洋合能枫丹唐悦</view>
    <scroll-view scroll-x="true" class="houseType marginNav">
      <view class="houseTypeItem" @tap="updataLocal">
        <image class="banner" src="/img/test.jpg" />
        <view>名著</view>
        <view>141.02㎡</view>
      </view>
      <view class="houseTypeItem" @tap="updataLocal">
        <image class="banner" src="/img/test.jpg" />
        <view>名著</view>
        <view>141.02㎡</view>
      </view>
      <view class="houseTypeItem" @tap="updataLocal">
        <image class="banner" src="/img/test.jpg" />
        <view>名著</view>
        <view>141.02㎡</view>
      </view>
      <view class="houseTypeItem" @tap="updataLocal">
        <image class="banner" src="/img/test.jpg" />
        <view>名著</view>
        <view>141.02㎡</view>
      </view>
      <view class="houseTypeItem" @tap="updataLocal">
        <image class="banner" src="/img/test.jpg" />
        <view>名著</view>
        <view>141.02㎡</view>
      </view>
    </scroll-view>
    <view class="nav">
      <view @tap="mobileShow">
        <icon class="iconfont icon-dianhua"></icon>
        <text>联系项目</text>
      </view>
      <view>
        <button open-type='share'>分享</button>
      </view>
      <!-- <view>分享楼盘</view> -->
      <view @tap="goReportUser">报备客户</view>
    </view>
    <view class="mask" wx:if="{{selMobileShow}}">
      <view class="mobile">
        <view class="selMobile" data-phone="18888888888" @tap="tel">项目驻场二狗子：18888888888</view>
        <view class="selMobile" data-phone="18888888888" @tap="tel">项目驻场二狗子：18888888888</view>
        <view class="selMobile" data-phone="18888888888" @tap="tel">项目驻场二狗子：18888888888</view>
        <view class="mobileClose" @tap="mobileShow">关闭</view>
      </view>
    </view>
  </view>
</template>

<script>
  import wepy from 'wepy'
  export default class CultureLocal extends wepy.page {
    config = {
      navigationBarTitleText: '项目详情'
    }
    components = {

    }

    mixins = []

    data = {
      img: '/img/test.jpg',
      test: '',
      userInfo: null,
      requestImgUrl: '',
      selMobileShow: false,
      swiperList: [],
      localList: null
    }

    computed = {

    }

    methods = {
      updataLocal(e) {
        // 根据点击的楼盘切换到当前页的数据
      },
      tel(e) {
        // 拨打电话
        wx.makePhoneCall({
          phoneNumber: e.currentTarget.dataset.phone,
        })
      },
      showAddress() {
        // 显示楼盘地址导航，地图
        
        wx.getLocation({
          type: 'gcj02', //返回可以用于wx.openLocation的经纬度
          success: function(res) {
            var latitude = res.latitude
            var longitude = res.longitude
            wx.openLocation({
              latitude: 33.42,
              longitude: 107.40,
              name: '艾泽拉斯',
              address: '艾泽拉斯艾泽拉斯艾泽拉斯',
              scale: 28
            })
          }
        })
      },
      collection() {
        // 收藏或取消收藏

      },
      mobileShow() {
        // 显示联系方式
        if (this.selMobileShow) {
          this.selMobileShow = false
        } else {
          this.selMobileShow = true
        }
      },
      goReportUser(e) {
        // 进入报备用户页
        this.$navigate(`/pages/reportLocal?id=${e.currentTarget.dataset.id}`)
      },
      goLocalMoreInfo(e) {
        // 产看楼盘的更多信息
        this.$navigate(`/pages/localMoreInfo?id=${e.currentTarget.dataset.id}`)
      },
      goRuleInfo(e) {
        // 进入预约列表
        this.$navigate(`/pages/ruleInfo?id=${e.currentTarget.dataset.id}`)
      }
    }

    events = {

    }

    onLoad(options) {
      this.id = options.id
      this.userInfo = this.$parent.globalData.userInfo
      this.requestImgUrl = this.$parent.globalData.requestImgUrl
      this.getFoodList()
    }
    onShareAppMessage() {
      let url = `pages/localInfo?id=${this.userInfo.id}`
      return {
        title: '弹出分享时显示的分享标题',
        desc: '分享页面的内容',
        imageUrl: '/img/logo.png',
        path: url
      }
    }
    getFoodList() {
      wx.request({
        url: `${this.$parent.globalData.requestUrl}/index`,
        method: 'GET',
        data: {
          id: this.id
        },
        success: data => {
          if (data.data.code == 1) {
            // this.diningRoom = data.data.data
            data = data.data.data
            this.swiperList = data.banner
            this.localList = data.floor[0]
            
            this.localList.cooperate_time = this.$parent.getLocalTime(this.localList.cooperate_time)
            this.localList.opening_time = this.$parent.getLocalTime(this.localList.opening_time)
            console.log(this.localList)
            // let i = 0
            // var reg = /\\|\//g
            // for (i in this.diningRoom) {
            //   // 替换反斜杠正则
            //   // replace(reg,"/")
            //   this.diningRoom[i]['img'] = this.diningRoom[i]['img'].replace(reg, '/')
            //   this.diningRoom[i]['detail'] = this.diningRoom[i]['detail'].replace(reg, '/')
            // }
            this.$apply()
          } else {
            wx.showModal({
              title: '',
              content: data.data.msg
            })
          }
        }
      })
    }
  }
</script>