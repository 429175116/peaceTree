<style lang="less">
  page{
      background-color: #f7f7f7;
  }
  
  .list{
    width: 750rpx;
    padding: 0;
  }
  image{
    width: 85rpx;
    height: 85rpx;
    border-radius: 85rpx;
  }
  icon{
    font-size: 26rpx !important;
    display: flex;
    align-items: center;
    justify-content: center;
    color: #979797;
    margin-left: 20rpx;
  }
  .tiem{
    width: 690rpx;
    height: 133.3rpx;
    padding: 0 30rpx;
    display: flex;
    align-items: center;
    justify-content: space-between;
    background-color: #fff;
  }
  .tiem view {
    font-size: 34rpx;
    color: #343434;
  }
  .con{
    display: flex;
    align-items: center;
    justify-content: flex-end;
  }
  input{
    font-size: 33rpx;
    color: #979797;
    text-align: right;
  }
  .interval{
    margin-top: 20rpx;
  }
  .sub{
    width: 670rpx;
    height: 94rpx;
    line-height: 94rpx;
    text-align: center;
    border-radius: 20rpx;
    background-color: #7bb312;
    color: #fff;
    font-size: 33rpx;
    margin: auto;
    margin-top: 100rpx;
  }
</style>
<template>
  <view>
      <view class="list">
        <view class="tiem">
          <view>头像</view>
          <view class="con">
            <image data-id="" src="{{img}}" />
            <icon class="iconfont icon-cujiantou1"></icon>
          </view>
        </view>
        <view class="tiem">
          <view>姓名</view>
          <view class="con">
            <input type="text" placeholder="输入姓名" value="" bindinput="getName"/>
            <icon class="iconfont icon-cujiantou1"></icon>
          </view>
        </view>
        <view class="tiem">
          <view>手机号</view>
          <view class="con">
            <input type="number" placeholder="输入手机号" value="" bindinput="getMobile" />
            <icon class="iconfont icon-cujiantou1"></icon>
          </view>
        </view>
        <view class="tiem interval">
          <view>所属门店</view>
          <view class="con">
            <input type="text" placeholder="输入门店邀请码" value="" bindinput="getStore" />
            <icon class="iconfont icon-cujiantou1"></icon>
          </view>
        </view>
        <view class="tiem">
          <view>工作地址</view>
          <view class="con">
            <input type="text" placeholder="输入工作地址" value="" bindinput="getAddress" />
          </view>
        </view>
        <view class="tiem">
          <view>我的职位</view>
          <view class="con">
            <input type="text" placeholder="输入职位" value="" bindinput="getPosition" />
          </view>
        </view>
        <view class="tiem">
          <view>所属公司</view>
          <view class="con">
            <input type="text" placeholder="输入公司" value="" bindinput="getCompany" />
          </view>
        </view>
      </view>
      <view class="sub" @tap="submit">保存</view>
  </view>
</template>

<script>
  import wepy from 'wepy'
  import check from '../mixins/check'
  export default class ModifyUserInfo extends wepy.page {
    config = {
      navigationBarTitleText: '编辑信息'
    }
    components = {
      
    }

    mixins = [check]

    data = {
      img: '/img/test.jpg',
      userInfo: new Object(),
      name: '',
      mobile: '',
      store: '',
      address: '',
      position: '',
      company: ''

    }

    computed = {

    }

    methods = {
      getName(e) {
        // 获取名称
        this.name = e.detail.value
      },
      getMobile(e) {
        // 获取电话
        this.mobile = e.detail.value
      },
      getStore(e) {
        // 获取门店
        this.store = e.detail.value
      },
      getAddress(e) {
        // 获取工作地址
        this.address = e.detail.value
      },
      getPosition(e) {
        // 获取职位
        this.position = e.detail.value
      },
      getCompany(e) {
        // 获取公司
        this.company = e.detail.value
      },
    }

    events = {

    }

    onLoad() {
      this.userInfo = this.$parent.globalData.userInfo
    }
    submit() {
      console.log(this.name)
      console.log(this.mobile)
      console.log(this.store)
      console.log(this.address)
      console.log(this.position)
      console.log(this.company)
      if (this.check.isNull(this.name)) {
        wx.showModal({
          title: '',
          content: '请输入名称'
        })
        return ''
      }
      if (this.check.isPhone(this.mobile)) {
        wx.showModal({
          title: '',
          content: '请输入正确的手机号'
        })
        return ''
      }
      if (this.check.isNull(this.store)) {
        wx.showModal({
          title: '',
          content: '请输入门店'
        })
        return ''
      }
      if (this.check.isNull(this.address)) {
        wx.showModal({
          title: '',
          content: '请输入工作地址'
        })
        return ''
      }
      if (this.check.isNull(this.position)) {
        wx.showModal({
          title: '',
          content: '请输入职位'
        })
        return ''
      }
      if (this.check.isNull(this.company)) {
        wx.showModal({
          title: '',
          content: '请输入公司'
        })
        return ''
      }
      // 信息提交
      wx.request({
        url: `${this.$parent.globalData.requestUrl}/users_edit`,
        method: 'POST',
        data: {
          uid: this.userInfo.id,
          name: this.name,
          mobile: this.mobile,
          store: this.store,
          address: this.address,
          position: this.position,
          company: this.company

        },
        success: data => {
          if (data.data.code == 1) {
            // var localReporList = data.data.data
            this.userInfo = data.data.data
            wx.showModal({
              title: '',
              content: '信息修改成功'
            })
            wx.navigateBack({
              data: -1
            })
          }
        }
      })
    }
  }
</script>